# アルバム作成画面の改善と編集機能の実装

## 📝 概要

アルバム作成時の必須項目を最小限にし、ユーザーがより気軽にアルバムを作成できるように改善しました。
また、カテゴリ選択時のデフォルト画像プレビュー表示、アルバム編集機能、アイキャッチ画像のUI改善を実装しました。

## ✅ 実装内容

### 1. アルバム作成画面の改善

#### 必須項目の変更
* アルバム名とカテゴリのみを必須項目に変更
* 写真は任意項目に変更（後から追加可能）
* バリデーションロジックを修正

#### ツールチップの追加
* アイキャッチ画像欄にInfoアイコンとツールチップを追加
  * 推奨サイズ: 1280×720px（16:9）
  * 最大容量: 5MB
  * 対応形式: JPEG, PNG, GIF
* 写真アップロード欄にInfoアイコンとツールチップを追加
  * 推奨サイズ: 各画像 2000px以下
  * 1枚あたりの最大容量: 10MB
  * 対応形式: JPEG, PNG, GIF
  * 後からいつでも追加可能

#### UI表示の改善
* ページ見出しを「アルバム名とカテゴリを入力してください（* 必須）」に変更
* 説明欄のラベルを「説明（任意）」に変更
* 写真アップロード欄のタイトルを「写真をアップロード（任意）」に変更

### 2. カテゴリ選択時のデフォルト画像プレビュー表示

* `src/lib/category-images.ts` を作成
  * カテゴリごとのデフォルト画像マッピングを定義
  * `getCategoryDefaultImage` 関数を実装
* カテゴリ選択時にデフォルト画像をプレビュー表示
* カスタム画像未設定時はカテゴリのデフォルト画像を表示
* アイキャッチ画像の表示を幅100%に変更（aspect-videoで16:9比率を維持）

### 3. アルバム編集機能の実装

#### アルバム編集コンポーネント（AlbumEditor）の作成
* `src/components/AlbumEditor.tsx` を作成
* 既存のアルバムデータを読み込んで編集可能
* メタ情報（タイトル、説明、カテゴリ、アイキャッチ画像、公開設定）を編集可能

#### アルバム編集画面の実装
* `src/app/albums/[id]/edit/page.tsx` を作成
* 作成者のみ編集可能（権限チェック実装）
* アイキャッチ画像の変更・削除機能
* アルバム情報の更新処理

#### アルバム詳細画面の改善
* 編集ボタンを追加（作成者のみ表示）
* カバー画像がない場合、カテゴリのデフォルト画像を使用
* 編集画面へのナビゲーションを実装

### 4. アイキャッチ画像のUI改善

* カテゴリ選択時のデフォルト画像表示を幅100%に変更
* カスタム画像選択時も幅100%で表示
* 16:9のアスペクト比を維持（aspect-video）
* デフォルト画像表示時に「デフォルト画像」ラベルを表示
* 画像変更ボタンの位置とサイズを調整

### 5. 公開設定のトグルボタン（PEND）

* Switchコンポーネントは実装済み
* レイアウト調整を実施（flex-shrink-0、gap-4を追加）
* 表示されない問題が解決せず、一旦PEND

## 📁 変更ファイル

### 新規作成

* `src/lib/category-images.ts` - カテゴリごとのデフォルト画像マッピング
* `src/components/AlbumEditor.tsx` - アルバム編集コンポーネント
* `src/app/albums/[id]/edit/page.tsx` - アルバム編集画面

### 更新

* `src/components/AlbumCreator.tsx` - アルバム作成画面の改善
  * 必須項目の変更
  * ツールチップの追加
  * UI表示の改善
  * カテゴリ選択時のデフォルト画像プレビュー表示
  * アイキャッチ画像の幅100%対応
* `src/components/AlbumViewer.tsx` - 編集ボタンの追加
* `src/app/albums/[id]/page.tsx` - カバー画像取得ロジックの改善、編集ボタンの追加

### ドキュメント

* `docs/GITHUB_ISSUE_ALBUM_CREATOR_IMPROVEMENT.md` - このIssue（新規）

## ✅ 検証項目

### アルバム作成画面

* [x] アルバム名とカテゴリのみで「アルバムを作成」ボタンが有効になる
* [x] 写真なしでもアルバム作成が完了する
* [x] アイキャッチ画像のInfoアイコンにホバーするとツールチップが表示される
* [x] 写真アップロード欄のInfoアイコンにホバーするとツールチップが表示される
* [x] すべての任意項目に「（任意）」の表記がある
* [x] ページ見出しに「* 必須」の説明がある
* [x] カテゴリ選択時にデフォルト画像がプレビュー表示される
* [x] アイキャッチ画像が幅100%で表示される

### アルバム編集機能

* [x] アルバム詳細画面に編集ボタンが表示される（作成者のみ）
* [x] 編集ボタンをクリックすると編集画面に遷移する
* [x] 編集画面でアルバム情報を編集できる
* [x] アイキャッチ画像を変更できる
* [x] アイキャッチ画像を削除できる（デフォルト画像に戻る）
* [x] 編集内容を保存できる
* [x] 保存後、アルバム詳細画面に戻る
* [x] 作成者以外は編集画面にアクセスできない

### カテゴリデフォルト画像

* [x] カテゴリ選択時にデフォルト画像が表示される
* [x] カテゴリ未選択時はデフォルト画像が表示されない
* [x] カスタム画像選択時はカスタム画像が表示される
* [x] カスタム画像削除時はデフォルト画像に戻る
* [x] アルバム詳細画面でカバー画像がない場合、カテゴリのデフォルト画像が使用される

### 公開設定（PEND）

* [ ] 公開設定のトグルボタンが表示される
* [ ] トグルボタンで公開/非公開を切り替えできる

## 🔧 技術的な詳細

### カテゴリデフォルト画像の実装

* `categoryDefaultImages` オブジェクトでカテゴリごとの画像URLを定義
* `getCategoryDefaultImage` 関数でカテゴリに応じた画像を取得
* Unsplashの画像URLを使用（1280×720px、16:9比率）

### アルバム編集機能の実装

* RLSポリシーにより、作成者のみ編集可能
* アイキャッチ画像のアップロード処理
* 既存のカバー画像の削除処理
* アルバム情報の更新処理

### バリデーションロジック

* `isFormValid` を `albumData.title && albumData.category` に変更
* 写真は任意項目として扱う
* `handleSubmit` で写真がない場合も即座に保存

## 📚 関連Issue

* なし

## 🎯 次のステップ

* 公開設定のトグルボタン表示問題の解決（PEND）
* アルバム作成時の写真アップロード機能の改善
* アルバム削除機能の実装

## ⚠️ 既知の問題

* 公開設定のトグルボタンが表示されない問題（PEND）

